\documentclass[11pt]{article}
\usepackage{natbib,mybigpackage}
\usepackage{algorithm}
%\usepackage{program}
%\usepackage{algpseudocode}
\usepackage{algorithmic}
\usepackage{listings}


\def\xbf{\mathbf{x}}
\def\zbf{\mathbf{z}}
\def\xibf{\mathbf{\xi}}
\title{ASSIGNMENT 5 }
\author{Chandan Kumar\\140123050\\Department of Mathematics}
\begin{document}
\titlepage
\newpage

\begin{enumerate}
\item[Q 1]  Use the Box-Muller method and Marsaglia-Bray method to do the following :\\
(a) Generate a sample of 100, 500 and 10000 values from N (0, 1). Hence find the
sample mean and variance.\\
(b) Draw histogram in all cases.
\end{enumerate}

\noindent{Code of BOX-MULLER for R}

\begin{lstlisting}

#BOX_MULLER method
f<-function(x1,x2)
{
   return (sqrt(-2*log(x1))*cos(2*pi*x2))
}

g<-function(x1,x2)
{
   return (sqrt(-2*log(x1))*sin(2*pi*x2))
}

p<-c(100,500,10000)

j<-1
z<-1
for(i in 1:3)
{	
	while(j<=p[i])
	{
		u1=runif(1);
		v=2*pi*runif(1);
  		z[j]=f(u1,v)
 		z[j+1]=g(u1,v)
 		j=j+2;	
	}


cat("\n For Number of values = ",p[i])
cat("\n The mean of the values generated for z1 is: ",mean(z))
cat("\n The variance of the values generated for z2 is: ",var(z))
cat("\n")
	
hist(z,col="grey",main=paste("Normal Distribution(Z1) for n =   ",p[i],"\nmean = ",mean(z),"\nvariance = ",var(z)),xlab="X",ylab="FRequency",breaks=50)
		
}


\end{lstlisting}



\noindent{\textbf{Output for Z1}\\
\begin{table}[h!]
\centering
\begin{tabular}{||c|c|c| c|c||}
\hline
&SIZE=100 &SIZE=500&SIZE=10000 \\
[0.5ex]
\hline\hline
Mean&0.2481781&0.06617793&0.03851711\\	
variance&0.8820116&1.004615&0.9958055\\
[1ex]
\hline
\end{tabular}
\caption{R output}
\label{table:1}
\end{table}\\


The histograms can be shown as:
\begin{figure}[H]
  \centering
\subfloat[$\xi_{1}$]{\includegraphics[width=0.45\textwidth]{BOXMULLER-1.png}} 
\subfloat[$\xi_{1}$]{\includegraphics[width=0.45\textwidth]{BOXMULLER-2.png}}\\
\subfloat[$\xi_{1}$]{\includegraphics[width=0.85\textwidth]{BOXMULLER-3.png}}\\
  \caption{Histograms for BOX-MULLER}
\end{figure}



\noindent{Code of MARSAGLIA-BRAY for R}

\begin{lstlisting}
#Marsaglia_Bray method
f<-function(v1,v2)
{
   return (sqrt(-2*log(v1^2 + v2^2)/(v1^2 + v2^2))*v1)
}

g<-function(v1,v2)
{
   return  (sqrt(-2*log(v1^2 + v2^2)/(v1^2 + v2^2))*v2)
}

p<-c(100,500,10000)

j<-1
z<-1
for(i in 1:3)
{	
	while(j<=p[i])
	{
		v1=2*runif(1)-1
                v2=2*runif(1)-1
		
		if((v1^2 + v2^2)<1)
		{
            z[j]=f(v1,v2)
			z[j+1]=g(v1,v2)
			j=j+2

		}	
	}


cat("\n For Number of values = ",p[i])
cat("\n The mean of the values generated for z1 is: ",mean(z))
cat("\n The variance of the values generated for z1 is: ",var(z))
cat("\n")
	

hist(z,col="pink",main=paste("Normal Distribution(Z2) for n =   ",p[i],"\nmean = ",mean(z),"\nvariance = ",var(z)),xlab="X",ylab="FRequency",breaks=50)		
}

\end{lstlisting}



\noindent{\textbf{Output for Z1}\\\\\\
\begin{table}[h!]
\centering
\begin{tabular}{||c|c|c| c|c||}
\hline
&SIZE=100 &SIZE=500&SIZE=10000 \\
[0.5ex]
\hline\hline
Mean&0.1393915&-0.03405595&-0.004290004\\	
variance&0.8799283&0.9502336&1.005569\\
[1ex]
\hline
\end{tabular}
\caption{R output}
\label{table:1}
\end{table}\\



The histograms can be shown as:



\begin{figure}[H]
  \centering
\subfloat[$\xi_{1}$]{\includegraphics[width=0.50\textwidth]{MARSAGLIA_BRAY-1.png}}
 \subfloat[$\xi_{1}$]{\includegraphics[width=0.50\textwidth]{MARSAGLIA_BRAY-2.png}}\\

\end{figure}

\begin{figure}[H]
  \centering
 \subfloat[$\xi_{1}$]{\includegraphics[width=0.85\textwidth]{MARSAGLIA_BRAY-3.png}}\\
  \caption{Histograms for MARSAGLIA-BRAY-METHOD}
\end{figure}



\noindent{\textbf{Observation:}}

\begin{enumerate}
\item The mean of the distribution calculated using both the methods comes out to be nearly equal to 0 which
is in fact the mean of Standard Normal Distribution.
\item The variance of these values indicate that they are going towards 1 which is equal to the theoretical
value if the variance and thus the given Random variable actually has a distribution which is the same as the Normal Distribution with variance 1 and mean 0. Furthermore the histograms resemble those of Normal Distribution.
\item There are two methods which can be used to generate the Normal Distribution: Box-Muller and Marsaglia-
Bray â€” both of them as shown above give nearly same precision but in the first one all the random numbers generated are used while in the other method the random numbers generated are checked whether that they are inside the circle of radius 1 before doing further instructions.
\item When the number of sample random variables is taken to as large as 10,000, the normal distribution of Ran-
dom variables becomes visible.
\item The probability density graph is symmetric about mean.
\end{enumerate}




\begin{enumerate}
\item[Q 2]Now use the above generated values to generated samples from $N(\mu = 0;\sigma^2 = 5)$ and $N(\mu = 5;\sigma^2 = 5)$. Hence plot the empirical(from sample with size 500) distribution function and theoretical distribution function in the same plot.
\end{enumerate}


\begin{lstlisting}

#Marsaglia_Bray method
f<-function(v1,v2)
{
   return (sqrt(-2*log(v1^2 + v2^2)/(v1^2 + v2^2))*v1)
}

g<-function(v1,v2)
{
   return  (sqrt(-2*log(v1^2 + v2^2)/(v1^2 + v2^2))*v2)
}

p<-c(100,500,10000)

k<-1
j<-1
z1<-1
z2<-1
for(i in 1:3)
{	
	while(j<=p[i])
	{
		v1=2*runif(1)-1
                v2=2*runif(1)-1
		
		if((v1^2 + v2^2)<1)
		{
                        z1[j]=sqrt(5)*f(v1,v2)
       			z1[j+1]=sqrt(5)*g(v1,v2)
			z2[k]=5+sqrt(5)*f(v1,v2)
			z2[k+1]=5+sqrt(5)*g(v1,v2)
			j=j+2
 			k=k+2

                        
          	}	
	}


cat("\n For Number of values = ",p[i])
cat("\n The mean of the values generated for z1 is: ",mean(z1))
cat("\n The variance of the values generated for z1 is: ",var(z1))
cat("\n The mean of the values generated for z2 is: ",mean(z2))
cat("\n The variance of the values generated for z2 is: ",var(z2))
cat("\n")
	
hist(z1,col="grey",main=paste("Normal Distribution(Z1) for n =   ",p[i],"\nTheoretical mean = 0\nmean = ",mean(z1),"\nTheoretical vriance = 5\nvariance = ",var(z1)),xlab="X",ylab="Frequency",breaks=50)

hist(z2,col="pink",main=paste("Normal Distribution(Z2) for n =   ",p[i],"\nTheoretical mean = 5 \nmean = ",mean(z2),"\nTheoretical variance = 5\n variance = ",var(z2)),xlab="X",ylab="Frequency",breaks=50)

if(p[i]==500)
{
	xseq<-seq(-10,15,0.01);
	h=ecdf(z1)
	m=ecdf(z2)
        cumulative<-pnorm(xseq,0,sqrt(5))
        plot(xseq, cumulative, col="darkorange", xlab="", ylab="Cumulative       Probability",type="l",lwd=2, cex=2, main="CDF of Mean = 0\n Variance = 5", cex.axis=.8) 
lines(h,col="blue")

cum<-pnorm(xseq,5,sqrt(5))
plot(xseq, cum, col="darkorange", xlab="", ylab="Cumulative       Probability",type="l",lwd=2, cex=2, main="CDF of Mean = 5\n Variance = 5", cex.axis=.8)
lines(m,col="grey") 
}
}

\end{lstlisting}

\noindent{\textbf{Output for Z1}\\
\begin{table}[h!]
\centering
\begin{tabular}{||c|c|c| c|c||}
\hline
&SIZE=100 &SIZE=500&SIZE=10000 \\
[0.5ex]
\hline\hline
Mean&-0.013143596&0.0009392699&-0.02135999\\	
variance&4.661646&5.143318&5.030225\\
[1ex]
\hline
\end{tabular}
\caption{R output for $N(\mu = 0;\sigma^2 = 5)$ }
\label{table:1}
\end{table}\\

\noindent{\textbf{Output for Z1}\\
\begin{table}[h!]
\centering
\begin{tabular}{||c|c|c| c|c||}
\hline
&SIZE=100 &SIZE=500&SIZE=10000 \\
[0.5ex]
\hline\hline
Mean&4.986856&5.000939&4.97864\\	
variance&4.661646&5.143318&5.030225\\
[1ex]
\hline
\end{tabular}
\caption{R output for $N(\mu = 5;\sigma^2 = 5)$ }
\label{table:1}
\end{table}\\



The histograms can be shown as:



\begin{figure}[H]
  \centering
\subfloat[$\xi_{1}$]{\includegraphics[width=0.50\textwidth]{Rplots-1.png}}
 \subfloat[$\xi_{1}$]{\includegraphics[width=0.50\textwidth]{Rplots-2.png}}\\

\end{figure}

\begin{figure}[H]
  \centering
 \subfloat[$\xi_{1}$]{\includegraphics[width=0.50\textwidth]{Rplots-3.png}}
 \subfloat[$\xi_{1}$]{\includegraphics[width=0.50\textwidth]{Rplots-4.png}}
  
\end{figure}

\begin{figure}[H]
  \centering
 \subfloat[$\xi_{1}$]{\includegraphics[width=0.50\textwidth]{Rplots-7.png}}
 \subfloat[$\xi_{1}$]{\includegraphics[width=0.50\textwidth]{Rplots-8.png}}
 \end{figure}
 
 \begin{figure}[H]
  \centering
 \subfloat[$\xi_{1}$]{\includegraphics[width=0.65\textwidth]{Rplots-5.png}}
 \end{figure}
 
 \begin{figure}[H]
  \centering
 \subfloat[$\xi_{1}$]{\includegraphics[width=0.65\textwidth]{Rplots-6.png}}
 \end{figure}
 
 



\newpage


\begin{enumerate}
\item[Q 3] Keep a track of the computational time required for both the methods. Which method
is faster ?
\end{enumerate}

\noindent{Code of R for BOX-MULLER}\\
\begin{lstlisting}
#BOX_MULLER method
f<-function(x1,x2)
{
   return (sqrt(-2*log(x1))*cos(2*pi*x2))
}

g<-function(x1,x2)
{
   return (sqrt(-2*log(x1))*sin(2*pi*x2))
}

p<-c(100,500,10000)

j<-1
z<-1
for(i in 1:3)
{
        ptm<-proc.time()	
	while(j<=p[i])
	{
		u1=runif(1);
		v=2*pi*runif(1);
  		z[j]=f(u1,v)
 		z[j+1]=g(u1,v)
 		j=j+2;	
	}


cat("\n For n = ",p[i],"The time taken by Box muller method\n")
print(proc.time() - ptm)
	
}

\end{lstlisting}
\newpage
\noindent{Code of R for MARSAGLIA-GRAY}\\
\begin{lstlisting}
#Marsaglia_Bray method
f<-function(v1,v2)
{
   return (sqrt(-2*log(v1^2 + v2^2)/(v1^2 + v2^2))*v1)
}

g<-function(v1,v2)
{
   return  (sqrt(-2*log(v1^2 + v2^2)/(v1^2 + v2^2))*v2)
}

p<-c(100,500,10000)

j<-1
z<-1
for(i in 1:3)
{	ptm<-proc.time()
	while(j<=p[i])
	{
		v1=2*runif(1)-1
                v2=2*runif(1)-1
		
		if((v1^2 + v2^2)<1)
		{
                        z[j]=f(v1,v2)
			z[j+1]=g(v1,v2)
			j=j+2

		}	
	}


cat("\n For n = ",p[i]," The time taken by Marsaglia Bray method\n")
print(proc.time() - ptm)
		
}

\end{lstlisting}

\noindent{\textbf{Output}}\\
\begin{table}[h!]
\centering
\begin{tabular}{||c|c|c| c|c||}
\hline
&USER &SYSTEM&ELAPSED \\
[0.5ex]
\hline\hline
n=100&0.000&0.008&0.002\\	
n=500&0.008&0.056&0.017\\
n=10000&0.192&0.004&0.189\\
[1ex]
\hline
\end{tabular}
\caption{Time taken by BOX-MULLER method}
\label{table:1}
\end{table}\\

\noindent{\textbf{Output}}\\
\begin{table}[h!]
\centering
\begin{tabular}{||c|c|c| c|c||}
\hline
&USER &SYSTEM&ELAPSED \\
[0.5ex]
\hline\hline
n=100&0.008&0.000&0.003\\	
n=500&0.020&0.048&0.018\\
n=10000&0.208&0.020&0.212\\
[1ex]
\hline
\end{tabular}
\caption{Time taken by MARSAGLIA-BRAY method method}
\label{table:1}
\end{table}\\

\noindent{\textbf{Observation:}}
Since we know that Marsaglia-gray method performs better than Box-muller method. But, here we see that Box-muller seems to perform better than marsaglia-gray method. This is because for small value of n sine and cosine are eassily calculated in less time but when the value for n increases the loop iterartion beats the sine and cosine approach in claculating the value.

\begin{enumerate}

\item[Q 4] For the Marsaglia-Bray method keep track of the proportional of values rejected. How does it compare with $1 - \frac{\pi}{4} ?$
\end{enumerate}
\noindent{Code of R for MARSAGLIA-GRAY}\\
\begin{lstlisting}
#Marsaglia_Bray method
f<-function(v1,v2)
{
   return (sqrt(-2*log(v1^2 + v2^2)/(v1^2 + v2^2))*v1)
}

g<-function(v1,v2)
{
   return  (sqrt(-2*log(v1^2 + v2^2)/(v1^2 + v2^2))*v2)
}

p<-c(100,500,10000)

count<-0
j<-1
z<-1
for(i in 1:3)
{
	while(j<=p[i])
	{
		v1=2*runif(1)-1
                v2=2*runif(1)-1
		
		if((v1^2 + v2^2)<1)
		{
                        z[j]=f(v1,v2)
			z[j+1]=g(v1,v2)
			j=j+2

		}
           count<-count+2	
	}


cat("\n n = ",p[i],"\t")
cat("Rejection probability: ",(1-(p[i]/count)))

		
}
cat("\n")


\end{lstlisting}

\noindent{\textbf{Output}}\\
\begin{table}[h!]
\centering
\begin{tabular}{||c|c||}
\hline
&Rejection Probability \\
[0.5ex]
\hline\hline
n=100&0.2537313\\	
n=500&0.2163009\\
n=10000&0.209111\\
[1ex]
\hline
\end{tabular}
\caption{Rejection Probabaility}
\label{table:1}
\end{table}\\






\end{document}
