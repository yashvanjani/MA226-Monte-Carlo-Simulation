noofrand <- 100

alpha <- 0.5

d <- 1.0344 - 0.0766*exp(2.2942*alpha)
a <- (2^alpha)*((1-exp(-0.5*d))^alpha)
b <- alpha*(d^(alpha-1))*exp(-1*d)
c <- a+b

u1 <- runif(noofrand, min=0, max=1)
X <- vector('numeric')

for(i in 1:noofrand) {
	if(u1[i] <= a/(a+b)) {
		val <- -2*log( 1 - 0.5*(c*(u1[i]^(1/alpha))) )
		X <- c(X, val)
	}
	else {
		val <- -1*log( c*(1-u1[i])/(alpha*(d^(alpha-1))) )
		X <- c(X, val)
	}
}

# u2 <- runif(noofrand, min=0, max=1)

gammadist <- vector('numeric')

for(i in 1:noofrand) {
	if(X[i] <= d) {
		val <- ( (X[i]^(alpha-1))*exp(-0.5*X[i]) ) / ( (2^(alpha-1))*((1-exp(-0.5*X[i]))^(alpha-1)) )
		if(u2[i] <= val) {
			gammadist <- c(gammadist, X[i])
	}
	else {
		val <- (d/X[i])^(1-alpha)
		if(u2[i] <= val) {
			gammadist <- c(gammadist, X[i])
	}
}

print(length(X))
print(length(gammadist))

png(file="gamma3.png")
hist(gammadist, xlab="Range of random number", col="red", border="black", breaks=50)
dev.off()